<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Mosallas</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="stylesheet" href="nft-style.css">
	<canvas id="whole" style="position: absolute;z-index:999"></canvas>
</head>
<body>

	<audio id="myAudio">
		<source src="win.mp3" type="audio/mpeg"></source>
	</audio>

	<audio id="myAudio1">
		<source src="count.mp3" type="audio/mpeg"></source>
	</audio>
	
	
		<script src="three.min.js"></script>
		<script src="ARnft.js"></script>
        	<script type='text/javascript' src='Tween.js'></script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
		<script type='text/javascript' src='OrbitControls.js'></script>
		<script src="confetti.js"></script>
		<script src="sweetalert2.all.min.js"></script>
	
	
    <script>
      
      let ps5
      let box
      let flag = true
      let secondStart = true
      let finished = false 
      let confetiStart = false
      let canPlay = true;
      let nft_loaded 
      let lastNumber = 9
      let coffee
      
     let carGltf
     let carModel
      

			ARnft.ARnft.init(800, 600, "archive/DataNFT/skht", 'config3.json', false, true)
			.then((nft) => {
				nft_loaded = nft;
				
				document.addEventListener('onInitThreejsRendering', (ev) => {
					const renderer = ev.detail.renderer;
					const scene = ev.detail.scene;
					const camera = ev.detail.camera;
					
  					renderer.outputEncoding = THREE.sRGBEncoding;
                                        renderer.textureEncoding = THREE.sRGBEncoding
					renderer.physicallyCorrectLights = true;
				
					const light1  = new THREE.AmbientLight(0xFFFFFF, 0.3);
					    light1.name = 'ambient_light';
					    camera.add( light1 );

					let directionalLight = new THREE.DirectionalLight(0xFFFFFF, 0.8 * Math.PI);
					directionalLight.position.set(0.5, 0, 0.866);
					camera.add(directionalLight);
				
					nft.addSimpleModel('./tarh.glb',10,280,42,50,function loaded(model){
						model.rotation.x = ((-3*Math.PI)/2)
						model.rotation.y = (-1*Math.PI)
						
						nft.setOnObjectClickListener('./tarh.glb',function(){
							
						Swal.fire({
						  title: 'قابل پرداخت : ۱۵۳,۰۰۰ تومان',
						  text: "پرداخت از طریق ؟",
						  icon: 'info',
						  showCancelButton: true,
						  confirmButtonColor: '#3085d6',
						  cancelButtonColor: '#d33',
						  confirmButtonText: 'کیف پول',
							cancelButtonText :'درگاه بانکی'
						}).then((result) => {
						  if (result.isConfirmed) {
						    Swal.fire(
						      'پرداخت موفق!',
						      'جریمه طرح ترافیک با موفقیت پرداخت شد',
						      'success'
						    ).then((result)=>{
						      var confettiElement = document.getElementById('whole');
							var confettiSettings = { target: confettiElement , clock : 56};
							var confetti = new ConfettiGenerator(confettiSettings);
							confetti.render();
							    var audio = document.getElementById("myAudio"); 
							    document.getElementById('myAudio').muted = false
								audio.play();
							    
							    Swal.fire(
								      'جایزه ت یادت نره',
								      'بعد هر پرداخت یه هدیه برات داریم',
								      'info'
								    ).then((result)=>{
								    try{
							 var mixer = new THREE.AnimationMixer(carModel);
							 var action = mixer.clipAction(carGltf.animations[1]);
							 action.setLoop(THREE.LoopOnce);
   							 action.clampWhenFinished = true;
							 action.play();
							 nft.mixers.push(mixer);
							}catch(e){
								alert(e);	
							}
							    });
						    })
						  }
						})	
						});
					});
					
					nft.addSimpleAnimatedCompressedModel('./limo2.glb',198,100,40,56,function loaded(gltf, model){
						carGltf = gltf
						carModel = model
//  						model.rotation.x = 42*Math.PI/180;
						nft.tickExtend = function (){
// 								model.rotation.y += 0.005
						};
						
						model.rotation.x = ((-3*Math.PI)/2)
						model.rotation.y = Math.PI/2
// 						model.rotation.z = (-1*Math.PI)
						
						nft.setOnObjectClickListener('./limo2.glb',function(){
							try{
							 var mixer = new THREE.AnimationMixer(model);
							 var action = mixer.clipAction(gltf.animations[0]);
							 action.setLoop(THREE.LoopOnce);
   							 action.clampWhenFinished = true;
							 action.play();
							 nft.mixers.push(mixer);
							}catch(e){
								alert(e);	
							}
						});
					});
				
					
				})
				
			
				document.addEventListener('getMatrixGL_RH', (ev) => {
					try{
						
					}catch(e){
						alert(e)
					}
				});
            });

    </script>
</body>

</html>
