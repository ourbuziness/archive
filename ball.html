<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Mosallas</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="stylesheet" href="nft-style.css">
	<canvas id="whole" style="position: absolute;z-index:999"></canvas>
</head>
<body>

	<audio id="myAudio">
		<source src="win.mp3" type="audio/mpeg"></source>
	</audio>

	<audio id="myAudio1">
		<source src="count.mp3" type="audio/mpeg"></source>
	</audio>
	
	
		<script src="three.min.js"></script>
		<script src="ARnft.js"></script>
        	<script type='text/javascript' src='Tween.js'></script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
		<script type='text/javascript' src='OrbitControls.js'></script>
		<script src="confetti.js"></script>
	
	
    <script>
      
      let nft_loaded 
    
      

			ARnft.ARnft.init(800, 600, "archive/DataNFT/notebook", 'config3.json', false, true)
			.then((nft) => {
				nft_loaded = nft;

				document.addEventListener('onInitThreejsRendering', (ev) => {
					const renderer = ev.detail.renderer;
					const scene = ev.detail.scene;
					const camera = ev.detail.camera;
					
  					renderer.outputEncoding = THREE.sRGBEncoding;
                                        renderer.textureEncoding = THREE.sRGBEncoding
					renderer.physicallyCorrectLights = true;
				
					const light1  = new THREE.AmbientLight(0xFFFFFF, 0.3);
					    light1.name = 'ambient_light';
					    camera.add( light1 );

					let directionalLight = new THREE.DirectionalLight(0xFFFFFF, 0.8 * Math.PI);
					directionalLight.position.set(0.5, 0, 0.866);
					camera.add(directionalLight);

          
          nft.addSimpleModel('./ball.glb' , 70 , 5 ,0,20 , function(model){
		  
		  nft.setOnObjectClickListener('./ball.glb',function(point){
// 			  var v = new THREE.Vector3()
// 			  camera.getWorldDirection(v);
// 			  alert("YMZ " + v.x +" , "+ v.y +" , "+v.z);
// 			  alert("YMZ (" + camera.position.x + " , " + camera.position.y + " , " + camera.position.z + ")" + "\n ("+camera.rotation.x + " , " + camera.rotation.y + " , " + camera.rotation.z + ")"  );
// 		 		alert("YMZ " + nft_loaded.renderer.camera.projectionMatrix);
// 			  model.getWorldPosition(v)
// 			 alert("YMZ " + v.x +" , "+ v.y +" , "+v.z);
// 			 const q = new THREE.Quaternion();
// 			  model.getWorldQuaternion(q)
// 			  var t = model.worldToLocal(point)
// 			alert("YMZ " + q.x +" , "+ q.y +" , "+q.z);
			  
			  
			   point.project( nft_loaded.renderer.camera );

    			var posx = Math.round(( point.x + 1 ) * rn.domElement.offsetWidth / 2 );
    			var posy = Math.round(( 1 - point.y ) * rn.domElement.offsetHeight / 2 );
			alert(" point : " + posx + " , "  +posy );  
		 		
		  		
		  });

						
// 						nft.tickExtend = function() {

// 						};
						
									});
          
          
                    nft.addSimpleModel('./goal.glb' , 70 , 250 ,0,3 , function(model){

						
									});
					
					
                    

				});
				
				
			
				document.addEventListener('getMatrixGL_RH', (ev) => {
					try{
// 						var m = ev.detail.matrixGL_RH
						
					}catch(e){
						alert(e)
					}
				});
            });

    </script>
</body>

</html>
